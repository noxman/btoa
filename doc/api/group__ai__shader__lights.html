<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Arnold 4.2.14.2 API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Light source sampling API</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Light Loop Methods</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrpb422192829e427e326a1226e70fabc8e"></a>This is the recommended API for looping over light source samples. </p>
</td></tr>
<tr class="memitem:gafcc1dd1a226ac31c5ec08a983b81c624"><td class="memItemLeft" align="right" valign="top">AI_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gafcc1dd1a226ac31c5ec08a983b81c624">AiLightsPrepare</a> (<a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *sg)</td></tr>
<tr class="memdesc:gafcc1dd1a226ac31c5ec08a983b81c624"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize light loop.  <a href="#gafcc1dd1a226ac31c5ec08a983b81c624">More...</a><br /></td></tr>
<tr class="separator:gafcc1dd1a226ac31c5ec08a983b81c624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1e562960afd6ebfb2862152a2d3ed95"><td class="memItemLeft" align="right" valign="top">AI_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gaf1e562960afd6ebfb2862152a2d3ed95">AiLightsGetSample</a> (<a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *sg)</td></tr>
<tr class="memdesc:gaf1e562960afd6ebfb2862152a2d3ed95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a sample within a light loop.  <a href="#gaf1e562960afd6ebfb2862152a2d3ed95">More...</a><br /></td></tr>
<tr class="separator:gaf1e562960afd6ebfb2862152a2d3ed95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ad996aa3de2b6b10f2f43b850655a00"><td class="memItemLeft" align="right" valign="top">AI_API <a class="el" href="structAtRGB.html">AtRGB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#ga5ad996aa3de2b6b10f2f43b850655a00">AiLightsGetShadowMatte</a> (<a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *sg)</td></tr>
<tr class="memdesc:ga5ad996aa3de2b6b10f2f43b850655a00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the shadow/occlusion value for the current shading point and the active set of lights.  <a href="#ga5ad996aa3de2b6b10f2f43b850655a00">More...</a><br /></td></tr>
<tr class="separator:ga5ad996aa3de2b6b10f2f43b850655a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a97ed1f105b3fcf2c0c24f841307a19"><td class="memItemLeft" align="right" valign="top">AI_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#ga5a97ed1f105b3fcf2c0c24f841307a19">AiLightsResetCache</a> (<a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *sg)</td></tr>
<tr class="memdesc:ga5a97ed1f105b3fcf2c0c24f841307a19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the light cache before running another light loop.  <a href="#ga5a97ed1f105b3fcf2c0c24f841307a19">More...</a><br /></td></tr>
<tr class="separator:ga5a97ed1f105b3fcf2c0c24f841307a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Light Getter Methods</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrpb35d355b57b3ee55a58356ce76503249"></a>These getters are to avoid slow AiNodeGet*() calls to access light parameters. Only the most common attributes are exposed for now. </p>
</td></tr>
<tr class="memitem:gaca36d6acc59d03fb882d445356b6078c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaca36d6acc59d03fb882d445356b6078c"></a>
AI_API AI_PURE <a class="el" href="structAtRGB.html">AtRGB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gaca36d6acc59d03fb882d445356b6078c">AiLightGetColor</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:gaca36d6acc59d03fb882d445356b6078c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for parameter color. <br /></td></tr>
<tr class="separator:gaca36d6acc59d03fb882d445356b6078c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6057ffba147f5bf5c4784f7cb8eab8e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae6057ffba147f5bf5c4784f7cb8eab8e"></a>
AI_API AI_PURE float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gae6057ffba147f5bf5c4784f7cb8eab8e">AiLightGetIntensity</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:gae6057ffba147f5bf5c4784f7cb8eab8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for parameter intensity. <br /></td></tr>
<tr class="separator:gae6057ffba147f5bf5c4784f7cb8eab8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e574636adcff432c6faafa93bb44ed2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3e574636adcff432c6faafa93bb44ed2"></a>
AI_API AI_PURE bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#ga3e574636adcff432c6faafa93bb44ed2">AiLightGetAffectDiffuse</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:ga3e574636adcff432c6faafa93bb44ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">DEPRECATED: Fast getter method for parameter affect_diffuse. <br /></td></tr>
<tr class="separator:ga3e574636adcff432c6faafa93bb44ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85bbd89990f57ade4e66d1fd84b4fcd9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga85bbd89990f57ade4e66d1fd84b4fcd9"></a>
AI_API AI_PURE bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#ga85bbd89990f57ade4e66d1fd84b4fcd9">AiLightGetAffectSpecular</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:ga85bbd89990f57ade4e66d1fd84b4fcd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">DEPRECATED: Fast getter method for parameter affect_specular. <br /></td></tr>
<tr class="separator:ga85bbd89990f57ade4e66d1fd84b4fcd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00335201b31f5ecb84cd062a1a398072"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga00335201b31f5ecb84cd062a1a398072"></a>
AI_API AI_PURE float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#ga00335201b31f5ecb84cd062a1a398072">AiLightGetDiffuse</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:ga00335201b31f5ecb84cd062a1a398072"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for the light's diffuse shading multiplier. <br /></td></tr>
<tr class="separator:ga00335201b31f5ecb84cd062a1a398072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4d6d43a01a6061ea984affaff39becd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac4d6d43a01a6061ea984affaff39becd"></a>
AI_API AI_PURE float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gac4d6d43a01a6061ea984affaff39becd">AiLightGetSpecular</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:gac4d6d43a01a6061ea984affaff39becd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for the light's specular shading multiplier. <br /></td></tr>
<tr class="separator:gac4d6d43a01a6061ea984affaff39becd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc7c592197906918bd5ef5331d896287"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabc7c592197906918bd5ef5331d896287"></a>
AI_API AI_PURE float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gabc7c592197906918bd5ef5331d896287">AiLightGetSSS</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:gabc7c592197906918bd5ef5331d896287"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for the light's SSS shading multiplier. <br /></td></tr>
<tr class="separator:gabc7c592197906918bd5ef5331d896287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae28d0c6ccb1d6940b948dcf93b2fc1ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae28d0c6ccb1d6940b948dcf93b2fc1ba"></a>
AI_API AI_PURE float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ai__shader__lights.html#gae28d0c6ccb1d6940b948dcf93b2fc1ba">AiLightGetVolume</a> (const <a class="el" href="structAtNode.html">AtNode</a> *node)</td></tr>
<tr class="memdesc:gae28d0c6ccb1d6940b948dcf93b2fc1ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast getter method for the light's volume shading multiplier. <br /></td></tr>
<tr class="separator:gae28d0c6ccb1d6940b948dcf93b2fc1ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gafcc1dd1a226ac31c5ec08a983b81c624"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AI_API void AiLightsPrepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *&#160;</td>
          <td class="paramname"><em>sg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize light loop. </p>
<p>Prepares the given shader globals for looping over lights. The current position and normal are cached so that the evaluation of lights (which might require evaluating filters and tracing shadow rays) can be skipped if nothing changes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sg</td><td>the shader globals context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf1e562960afd6ebfb2862152a2d3ed95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AI_API bool AiLightsGetSample </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *&#160;</td>
          <td class="paramname"><em>sg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a sample within a light loop. </p>
<p>After <code><a class="el" href="group__ai__shader__lights.html#gafcc1dd1a226ac31c5ec08a983b81c624" title="Initialize light loop. ">AiLightsPrepare()</a></code> has been called, this function should be called inside a while loop. The call returns true if a valid light sample has been set, in which case all the light source related fields in the shader globals context are set:</p>
<ul>
<li><code>sg-&gt;Li</code> &ndash; incident radiance, same as <code>sg-&gt;Liu</code> * (1 - <code>sg-&gt;Lo</code>)</li>
<li><code>sg-&gt;Ld</code> &ndash; normalized vector towards the light sample</li>
<li><code>sg-&gt;Lo</code> &ndash; RGB occlusion factor, where (1,1,1) means fully occluded</li>
<li><code>sg-&gt;Liu</code> &ndash; unoccluded incident radiance (this is the same as <code>sg-&gt;Li</code> without considering occlusion)</li>
<li><code>sg-&gt;Ldist</code> &ndash; distance towards the light source</li>
<li><code>sg-&gt;we</code> &ndash; weight of the light sample</li>
<li><code>sg-&gt;Lp</code> &ndash; pointer to the light's <a class="el" href="structAtNode.html" title="This represents a node in Arnold. ">AtNode</a></li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sg</td><td>the shader globals context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if a valid sample was available </dd></dl>

</div>
</div>
<a class="anchor" id="ga5ad996aa3de2b6b10f2f43b850655a00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AI_API <a class="el" href="structAtRGB.html">AtRGB</a> AiLightsGetShadowMatte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *&#160;</td>
          <td class="paramname"><em>sg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the shadow/occlusion value for the current shading point and the active set of lights. </p>
<p>Shadow occlusion is calculated by accumulating all of the <code>sg-&gt;Lo</code> values for each of the lights weighted by their respective <code>sg-&gt;we</code> values, and then determining the maximum matte value of all the lights. It is this maximum value which is returned. This value can never be greater than 1.0.</p>
<p>It is not neccessary to call <code><a class="el" href="group__ai__shader__lights.html#gafcc1dd1a226ac31c5ec08a983b81c624" title="Initialize light loop. ">AiLightsPrepare()</a></code> prior to calling this function. If the light samples have not been set up, then this function will prepare them by automatically calling <code><a class="el" href="group__ai__shader__lights.html#gafcc1dd1a226ac31c5ec08a983b81c624" title="Initialize light loop. ">AiLightsPrepare()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sg</td><td>the shader globals context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the amount of shadow occlusion (clamped to 1.0) </dd></dl>

</div>
</div>
<a class="anchor" id="ga5a97ed1f105b3fcf2c0c24f841307a19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AI_API void AiLightsResetCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAtShaderGlobals.html">AtShaderGlobals</a> *&#160;</td>
          <td class="paramname"><em>sg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the light cache before running another light loop. </p>
<p>The after calling <code><a class="el" href="group__ai__shader__lights.html#gafcc1dd1a226ac31c5ec08a983b81c624" title="Initialize light loop. ">AiLightsPrepare()</a></code> various lighting data are cached so that subsequent calls will incur no overhead. However, if certain values change in the shader globals, that cached lighting data may not be valid and a reset is necessary to compute new data. This is particularly true if you wish to switch from hemispherical lighting to full-sphere lighting, change the surface normal or position, or change tracesets for shadow rays in a particular light loop.</p>
<dl class="section warning"><dt>Warning</dt><dd>Resetting the light cache when it is not strictly necessary may severely impact performance, as extra shadow rays are traced unnecessarily. Be sure to only use this when you need to make sure and gather a new set of light samples.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sg</td><td>the shader globals context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<br>
<!--We could define a thematic change here by using the tag <hr class="footer"/> -->
<div id="geninfo" style="text-align: center;">
 <font size=-2 color=#C9C9C9>&copy 2009-2016 Solid Angle SL &middot all rights reserved &middot <a href="http://www.solidangle.com"><font size=-2 color=#C9C9C9>www.solidangle.com</font></a></font>
 <div id="geninfo" style="text-align: right; margin-top: 10 px; margin-right: 10px;">
 </div>
</div>
</body>
</html>
